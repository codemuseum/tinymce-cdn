document.open();document.write("\u003C!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"\u003E\r\n\u003Chtml xmlns=\"http://www.w3.org/1999/xhtml\"\u003E\r\n\u003Chead\u003E\r\n\t\u003Ctitle\u003E\u003C/title\u003E\r\n\t\u003Cmeta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\" /\u003E\r\n\t\u003Cscript type=\"text/javascript\" src=\"" + document.location.protocol +"//s3.amazonaws.com/tinymce-cdn/plugins/fullscreen/../../tiny_mce.js\"\u003E\u003C/script\u003E\r\n\t\u003Cscript type=\"text/javascript\"\u003E\r\n\t\tfunction patchCallback(settings, key) {\r\n\t\t\tif (settings[key])\r\n\t\t\t\tsettings[key] = \"window.opener.\" + settings[key];\r\n\t\t}\r\n\r\n\t\tvar settings = {}, paSe = window.opener.tinyMCE.activeEditor.settings, oeID = window.opener.tinyMCE.activeEditor.id;\r\n\r\n\t\t// Clone array\r\n\t\tfor (var n in paSe)\r\n\t\t\tsettings[n] = paSe[n];\r\n\r\n\t\t// Override options for fullscreen\r\n\t\tfor (var n in paSe.fullscreen_settings)\r\n\t\t\tsettings[n] = paSe.fullscreen_settings[n];\r\n\r\n\t\t// Patch callbacks, make them point to window.opener\r\n\t\tpatchCallback(settings, 'urlconverter_callback');\r\n\t\tpatchCallback(settings, 'insertlink_callback');\r\n\t\tpatchCallback(settings, 'insertimage_callback');\r\n\t\tpatchCallback(settings, 'setupcontent_callback');\r\n\t\tpatchCallback(settings, 'save_callback');\r\n\t\tpatchCallback(settings, 'onchange_callback');\r\n\t\tpatchCallback(settings, 'init_instance_callback');\r\n\t\tpatchCallback(settings, 'file_browser_callback');\r\n\t\tpatchCallback(settings, 'cleanup_callback');\r\n\t\tpatchCallback(settings, 'execcommand_callback');\r\n\t\tpatchCallback(settings, 'oninit');\r\n\r\n\t\t// Set options\r\n\t\tdelete settings.id;\r\n\t\tsettings['mode'] = 'exact';\r\n\t\tsettings['elements'] = 'fullscreenarea';\r\n\t\tsettings['add_unload_trigger'] = false;\r\n\t\tsettings['ask'] = false;\r\n\t\tsettings['document_base_url'] = window.opener.tinyMCE.activeEditor.documentBaseURI.getURI();\r\n\t\tsettings['fullscreen_is_enabled'] = true;\r\n\t\tsettings['fullscreen_editor_id'] = oeID;\r\n\t\tsettings['theme_advanced_resizing'] = false;\r\n\t\tsettings['strict_loading_mode'] = true;\r\n\r\n\t\tsettings.save_onsavecallback = function() {\r\n\t\t\twindow.opener.tinyMCE.get(oeID).setContent(tinyMCE.get('fullscreenarea').getContent({format : 'raw'}), {format : 'raw'});\r\n\t\t\twindow.opener.tinyMCE.get(oeID).execCommand('mceSave');\r\n\t\t\twindow.close();\r\n\t\t};\r\n\r\n\t\tfunction unloadHandler(e) {\r\n\t\t\tmoveContent();\r\n\t\t}\r\n\r\n\t\tfunction moveContent() {\r\n\t\t\twindow.opener.tinyMCE.get(oeID).setContent(tinyMCE.activeEditor.getContent());\r\n\t\t}\r\n\r\n\t\tfunction closeFullscreen() {\r\n\t\t\tmoveContent();\r\n\t\t\twindow.close();\r\n\t\t}\r\n\r\n\t\tfunction doParentSubmit() {\r\n\t\t\tmoveContent();\r\n\r\n\t\t\tif (window.opener.tinyMCE.selectedInstance.formElement.form)\r\n\t\t\t\twindow.opener.tinyMCE.selectedInstance.formElement.form.submit();\r\n\r\n\t\t\twindow.close();\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tfunction render() {\r\n\t\t\tvar e = document.getElementById('fullscreenarea'), vp, ed, ow, oh, dom = tinymce.DOM;\r\n\r\n\t\t\te.value = window.opener.tinyMCE.get(oeID).getContent();\r\n\r\n\t\t\tvp = dom.getViewPort();\r\n\t\t\tsettings.width = vp.w;\r\n\t\t\tsettings.height = vp.h - 15;\r\n\r\n\t\t\ttinymce.dom.Event.add(window, 'resize', function() {\r\n\t\t\t\tvar vp = dom.getViewPort();\r\n\r\n\t\t\t\ttinyMCE.activeEditor.theme.resizeTo(vp.w, vp.h);\r\n\t\t\t});\r\n\r\n\t\t\ttinyMCE.init(settings);\r\n\t\t}\r\n\r\n\t\t// Add onunload\r\n\t\ttinymce.dom.Event.add(window, \"beforeunload\", unloadHandler);\r\n\t\u003C/script\u003E\r\n\t\u003Cbase target=\"_self\" /\u003E\r\n\u003C/head\u003E\r\n\u003Cbody style=\"margin:0;overflow:hidden;width:100%;height:100%\" scrolling=\"no\" scroll=\"no\"\u003E\r\n\u003Cform onsubmit=\"doParentSubmit();\"\u003E\r\n\u003Ctextarea id=\"fullscreenarea\" style=\"width:100%; height:100%\"\u003E\u003C/textarea\u003E\r\n\u003C/form\u003E\r\n\r\n\u003Cscript type=\"text/javascript\"\u003E\r\n\trender();\r\n\u003C/script\u003E\r\n\r\n\u003C/body\u003E\r\n\u003C/html\u003E\r\n");document.close();